/*! custup 2024-01-04 */
import CustUpCore from"../core/custupCore.js";import _customStyles from"../utils/_customStyles.js";import file_types from"../utils/filetypes.js";export default class CustUp extends CustUpCore{constructor(e){super(e),this.uiSelect()}uiSelect(){switch(this.options.ui_type){case"resumeUploaderUI":this.resumeUploaderUI();break;case"bare":this.bareUploaderUI();break;case"detached":this.detachedUploaderUI();break;case"profilePicture":this.profilePictureUI()}this.map_override_styles_to_default_styles(this.options.default_styles_override),this.options.autoInitialize&&this.initializeUI()}resumeUploaderUI(){this.map_override_styles_to_default_styles({outerContainer:["RUIOuterContainer",!0],defaultUI:["RUIDefaultUIEl",!0],defaultUIUploadIconsContainer:["RUIDefaultUIUploadIconsContainer",!0]}),this.options.allowed_sources=null,this.options._custupDefaultUploadSentence=`<div style="color: gray; line-height: 30px; pointer-events: none;">
            <div><b style="color: black;">Upload a file</b> or drag and drop here</div>
            <div>Accepted Files: ${0==this.options.allowed_file_types.length?"All":this.options.allowed_file_types.join(", ").toUpperCase()}
            Up to ${this.parseFileSize(this.options.maximumAllowedFileSize)}
            </div>
        </div>`,(this.options.allowed_tools=null)===document.querySelector("[href*='all.min.']")&&null===document.querySelector("[href*='resumeUploaderUI.']")&&console.warn(this.libraryName+": Please include the resumeUploaderUI css file")}bareUploaderUI(){this.map_override_styles_to_default_styles({outerContainer:["BareUIOuterContainer",!0],innerContainer:["BareUIInnerContainer",!0],defaultUI:["BareUIDefaultUIEl",!0],defaultUIUploadIconsContainer:["BareUIDefaultUIUploadIconsContainer",!0]}),this.options.allowed_tools=null,this.options.allowed_sources=null,this.options.disable_scrollbar=!0;var e=document.createElement("div"),t=document.createElement("div"),l=(t.className="BareUIDefaultUIInnerContent",document.createElement("div")),n=(l.style.width="50px",l.style.height="50px",l.innerHTML=this.ui_icons.upload_circle,document.createElement("div")),o=(n.innerHTML='<b style="color: black;">Drop files here</b>',document.createElement("div"));o.className="BareUIDefaultUIInnerContentLastItem",o.innerHTML="or <span>Select files</span>",t.appendChild(l),t.appendChild(n),t.appendChild(o),e.appendChild(t),this.options._custupDefaultUploadSentence=e.innerHTML,null===document.querySelector("[href*='all.min.']")&&null===document.querySelector("[href*='bare.']")&&console.warn(this.libraryName+": Please include the bare css file")}detachedUploaderUI(){this.options.use_default_file_display_ui=!1,this.options.persist_default_ui=!0,this.options.allowed_sources=null;var e=document.createElement("div"),t=document.createElement("div"),l=(t.style.lineHeight="30px",document.createElement("div")),n=(l.innerHTML=this.ui_icons.unknown_file,l.className="DUIIconContainer",document.createElement("div")),o=(n.innerHTML="Drag and drop your files here",n.className="DUITextContainer1",document.createElement("div"));o.innerHTML="or Click to browse from your computer",t.appendChild(l),t.appendChild(n),t.appendChild(o),e.append(t),this.options._custupDefaultUploadSentence=e.innerHTML;const d=document.createElement("div"),i=(d.className="DUIBottomButtonContainer",document.createElement("button")),r=(i.className="DUIUploadButton",i.innerHTML="Upload",i.type="button",i.onclick=e=>this.upload(),document.createElement("button"));r.className="DUIClearButton",r.innerHTML="Clear",r.type="button",r.onclick=()=>{this.clear_files(),d.style.display="none",this._custupFooterEl.querySelector(".inner").innerHTML=""};l=0==this.options.allowed_tools?.length||this.options.allowed_tools?.includes("clear_files"),n=0==this.options.allowed_tools?.length||this.options.allowed_tools?.includes("upload");l&&d.appendChild(r),n&&d.appendChild(i),this.map_override_styles_to_default_styles({outerContainer:["DUIOuterContainer",!0],innerContainer:["DUIInnerContainer",!0],custupInnerContainerWrapperEl:["DUIInnerContainerWrapper",!0],defaultUI:["DUIDefaultUI",!0],footerContainer:"DUIFooterContainer",headerContainer:"DUIHeaderContainer",file_wrapper_el:"DHIFileInnerWrapper"}),this.on("file.beforeAdded",e=>{const t=document.createElement("div");t.style.width="100%",t.className="DUIFileContainer",t.id=e.file.id;var l=document.createElement("div"),n=(l.className="DHIFilePreviewEl",this.makeFileDisplayElement(e.file,l,e.base64),document.createElement("div")),o=(n.className="DHIFileDetails",document.createElement("div")),i=(o.className="DHITextContainer",document.createElement("div")),r=document.createElement("div"),s=(r.className="DHIFilesizeContainer",r.innerHTML=this.parseFileSize(e.file.size),document.createElement("div")),i=(s.className="DHIProgressText",i.innerHTML=this.clipFileNameIfShouldClip(e.file.name),o.appendChild(i),o.appendChild(s),document.createElement("div")),s=(i.className="DHIUploadProgressContainer",document.createElement("div")),a=(s.className="DHIMainProgress",document.createElement("div")),s=(a.className="DHIProgressInner",s.appendChild(a),i.appendChild(s),a.style.width="0%",n.appendChild(o),n.appendChild(r),n.appendChild(i),document.createElement("div"));s.className="DHICloseBtnContainer",s.innerHTML=this.ui_icons.red_circle_cancel,s.onclick=()=>this.remove_file(e.file.id,()=>t.remove()),t.appendChild(l),t.appendChild(n),t.appendChild(s),this._custupFooterEl.querySelector(".inner").append(t),d.style.display="flex"}),this.on("library.init",()=>{this._custupFooterEl.append(d)}),this.on("file.removed",e=>{0==e.files_count&&(d.style.display="none")}),this.on("upload.beforeStart",()=>{i.disabled=!0,r.disabled=!0,i.innerHTML="Uploading..."}),this.on("upload.success",e=>{i.disabled=!1,r.disabled=!1,i.innerHTML="Upload"}),this.on("upload.error",e=>{i.disabled=!1,r.disabled=!1,i.innerHTML="Upload";var t=this._custupFooterEl.querySelector(".inner").querySelector("div.DUIFileContainer#"+e.file.id),t=(t.querySelector(".DHIUploadProgressContainer").querySelector(".DHIProgressInner").style.backgroundColor="red",t.querySelector(".DHIProgressText")),l=document.createElement("div");l.className="DHIRetryButton",l.innerHTML="Retry",l.onclick=()=>this.retry_upload(e.file.id),this.options.single_upload||(t.innerHTML=""),this.options.single_upload||t.append(l)}),this.on("upload.progress",e=>{var t=this._custupFooterEl.querySelector(".inner").querySelector("div.DUIFileContainer#"+e.file.id),l=t.querySelector(".DHIUploadProgressContainer"),t=(l.style.display="flex",t.querySelector(".DHIProgressText")),l=l.querySelector(".DHIProgressInner"),n=(l.style.backgroundColor="rgb(39, 39, 148)",e.progressEvent.loaded/e.progressEvent.total*100);l.style.width=n+"%",t.innerHTML=100==n?"100%":n.toFixed(1)+"%",e.progressEvent.loaded>=e.progressEvent.total&&(l.style.backgroundColor="green")}),null===document.querySelector("[href*='all.min.']")&&null===document.querySelector("[href*='detached.']")&&console.warn(this.libraryName+": Please include the detached css file")}profilePictureUI(){this.options.allowed_sources=null,this.options.display_ui_tools=!1,this.options.disable_scrollbar=!0,this.options.minNumberOfFiles=1,this.options.maxNumberOfFiles=1,this.options.show_file_remove_btn=!1,this.options.show_file_details_container=!1,this.options.allowed_file_types=["jpg","png","jpeg","jpg"],this.map_override_styles_to_default_styles({outerContainer:["PPUIOuterContainer",!0],innerContainer:["PPUIInnerContainer",!0],custupInnerContainerWrapperEl:["PPUIInnerContainerWrapper",!0],fileDisplayUI:["PPUIFileDisplayUI",!0],fileUIOuterContainer:["PPUIFileUIOuter",!0],fileUI:["PPUIFileUI",!0],defaultUI:["PPUIDefaultUI",!0],footerContainer:"PPUIFooterContainer"});var e=document.createElement("div"),t=(e.className="PPUIDefaultUIInner",document.createElement("div")),l=(t.className="PPUIDefaultUIInnerIcon",t.innerHTML=this.ui_icons.plus,document.createElement("div"));l.innerHTML="Upload Profile Picture",e.appendChild(t),e.appendChild(l),this.options._custupDefaultUploadSentence=e.innerHTML;const n=document.createElement("div");n.className="PPUIButtonToolsContainer";var t=document.createElement("button"),l=(t.className="PPUIUploadBtn",t.innerHTML="Upload",t.type="button",t.onclick=()=>this.upload(),document.createElement("button")),e=(l.className="PPUIClearBtn",l.type="button",l.innerHTML="Clear",l.onclick=()=>this.clear_files(),0==this.options.allowed_tools?.length||this.options.allowed_tools?.includes("clear_files")),o=0==this.options.allowed_tools?.length||this.options.allowed_tools?.includes("upload");e&&n.appendChild(l),o&&n.appendChild(t),this.on("file.afterAdded",()=>{this._custupFooterEl.querySelector(".inner").append(n)}),this.on("file.all_removed",()=>{this._custupFooterEl.querySelector(".inner").innerHTML=""}),null===document.querySelector("[href*='all.min.']")&&null===document.querySelector("[href*='profilePicture.']")&&console.warn(this.libraryName+": Please include the profilePicture css file")}}